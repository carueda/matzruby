#!/bin/bash
# configure ruby 1.8.7p352 build for arm-linux -- 11/19/12 brent@mbari.org
# for gcc x86 add:
#  -fno-stack-protector
# to CFLAGS
# also note that gcc 4.7 is not compatible.  Use gcc 4.6 or lower.
: ${CFLAGS:="-O2 -g -fno-stack-protector"}
: ${CXXFLAGS:=$CFLAGS}
for mod in mbarilib termios .; do 
  [ -r $mod/Makefile ] && make -C $mod MINIRUBY=miniruby distclean
done
export CC CFLAGS CXXFLAGS
ESP_PREFIX=${ESP_PREFIX-/opt/mbari}
rm -f config.cache configure `find ext -name Makefile` && 
autoconf && exec configure --prefix=${ESP_PREFIX} \
  --enable-mbari-api --enable-pthread --disable-ucontext $@
